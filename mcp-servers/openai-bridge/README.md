# OpenAI Bridge MCP Server

MCP server that provides GPT-5 access to Claude Code for multi-model brainstorming.

## Setup

1. **Install dependencies:**
```bash
cd ~/.claude/mcp-servers/openai-bridge
npm install
npm run build
```

2. **Set OpenAI API key:**
```bash
export OPENAI_API_KEY="sk-..."
```

Or add to your shell profile (~/.zshrc, ~/.bashrc):
```bash
echo 'export OPENAI_API_KEY="sk-..."' >> ~/.zshrc
```

3. **Configure in Claude settings:**

Add to `~/.claude/settings.json`:
```json
{
  "mcpServers": {
    "openai-bridge": {
      "command": "node",
      "args": ["~/.claude/mcp-servers/openai-bridge/dist/index.js"],
      "env": {
        "OPENAI_API_KEY": "${OPENAI_API_KEY}"
      }
    }
  }
}
```

4. **Restart Claude Code**

## Usage

### Via Multi-Model Brainstormer Agent

The easiest way to use this is through the `multi-model-brainstormer` agent:

```
User: "Brainstorm: How should I architect the payment system?"

Claude Code will automatically:
1. Detect "brainstorm" keyword
2. Invoke multi-model-brainstormer agent
3. Agent uses mcp__openai-bridge__ask_gpt5 tool
4. Orchestrates 2-4 rounds of Claude â†” GPT-5 dialogue
5. Synthesizes insights from both models
```

### Direct Tool Usage

You can also call the tool directly:

```typescript
// Ask GPT-5 a question
mcp__openai-bridge__ask_gpt5({
  prompt: "What are the trade-offs between microservices and monolith?",
  model: "gpt-4o", // or "gpt-5-turbo" or "gpt-5"
  max_tokens: 1000,
  temperature: 0.7
})

// Check usage stats
mcp__openai-bridge__get_usage_stats()
```

## Models Available

- **gpt-4o** (default) - Most cost-effective, excellent quality (~$0.005/1K prompt tokens)
- **gpt-5-turbo** - Fast GPT-5 variant (~$0.01/1K prompt tokens)
- **gpt-5** - Full GPT-5 model (~$0.03/1K prompt tokens)

## Cost Tracking

The server automatically tracks:
- Total tokens used
- Session cost
- Cumulative cost

Check anytime with `get_usage_stats` tool.

**Typical brainstorm session cost:**
- 2-round dialogue: ~2600 tokens = ~$0.08
- 4-round dialogue: ~4500 tokens = ~$0.14

## Troubleshooting

**Error: "OpenAI API error: Incorrect API key"**
- Check that OPENAI_API_KEY is set: `echo $OPENAI_API_KEY`
- Get your API key from https://platform.openai.com/api-keys
- Make sure to restart Claude Code after setting the env var

**Error: "Insufficient credits"**
- Add credits at https://platform.openai.com/account/billing
- Your ChatGPT subscription is separate from API credits

**Error: "Model not found"**
- GPT-5 might not be released yet - use "gpt-4o" as fallback
- Update model name when GPT-5 is officially available

## Files

- `index.ts` - MCP server implementation
- `package.json` - Dependencies
- `tsconfig.json` - TypeScript configuration
- `dist/index.js` - Compiled JavaScript (generated by `npm run build`)
